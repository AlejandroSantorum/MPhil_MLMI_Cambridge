tools/htkbin/HNTrainSGD.GPU -B -A -D -V -T 3 -C basic.cfg -C finetune.cfg -S lib/flists/dnn.train.scp -N lib/flists/dnn.cv.scp -l LABEL -I train.mlf -H hmm0/init/MMF -M hmm0 hmms.mlist 

HTK Configuration Parameters[28]
  Module/Tool     Parameter                  Value
#                 GPUID                          0
#                 WEIGHTDECAY             0.001000
#                 UPDATETARGETPEN              TRUE
#                 UPDATEMODE            BATCHLEVEL
#                 UPDATECLIP              0.320000
#                 STOPDIFF                0.000100
#                 SHUFFLEKIND             QUICKNET
#                 RAMPSTART               0.000500
#                 NEWBOBCRITERION               ACC
#                 MOMENTUM                0.500000
#                 MINIBATCHSIZE                800
#                 MINEPOCHNUM                   12
#                 MAXEPOCHNUM                   16
#                 LRSCHEDULER               NEWBOB
#                 LOGPRIOROBSV         -135.000000
#                 LEARNRATE               0.000500
# HNCACHE         TRACE                          1
# HMATH           TRACE                          1
# HCUDA           TRACE                          1
# HANNET          TRACE                          1
#                 DATACACHESIZE          200000000
#                 DATAACCESSKIND         FRAMERAND
#                 CRITERION                   XENT
# HPARM           VARSCALEFN      lib/info/ident_cvn_E_D_A_Z
# HPARM           VARSCALEPATHMASK             *.%%%
# HPARM           VARSCALEMASK               *.%%%
# HPARM           VARSCALEDIR     lib/cvn/cvn_E_D_A_Z
#                 TARGETKIND          MFCC_E_D_A_Z


HTK Version Information
Module     Version    Who    Date      : CVS Info
HNTrainSGD 3.5.0      CUED   12/10/15  : $Id: HNTrainSGD.c,v 1.0 2015/10/12 12:07:24 cz277 Exp $
HShell     3.5.0      CUED   12/10/15  : $Id: HShell.c,v 1.2 2015/10/12 12:07:24 cz277 Exp $
HMem       3.5.0      CUED   12/10/15  : $Id: HMem.c,v 1.2 2015/10/12 12:07:24 cz277 Exp $
HMath      3.5.0      CUED   12/10/15  : $Id: HMath.c,v 1.2 2015/10/12 12:07:24 cz277 Exp $
HSigP      3.5.0      CUED   12/10/15  : $Id: HSigP.c,v 1.1.1.1 2006/10/11 09:54:58 jal58 Exp $
HWave      3.5.0      CUED   12/10/15  : $Id: HWave.c,v 1.2 2015/10/12 12:07:24 cz277 Exp $
HLabel     3.5.0      CUED   12/10/15  : $Id: HLabel.c,v 1.2 2015/10/12 12:07:24 cz277 Exp $
HAudio     3.5.0      CUED   12/10/15  : $Id: HAudio.c,v 1.1.1.1 2006/10/11 09:54:57 jal58 Exp $
HANNet     3.5.0      CUED   12/10/15  : $Id: HANNet.c,v 1.0 2015/10/12 12:07:24 cz277 Exp $
HCUDA      3.5.0      CUED   12/10/15  : $Id: HCUDA.cu,v 1.0 2015/10/12 12:07:23 cz277 Exp $
HModel     3.5.0      CUED   12/10/15  : $Id: HModel.c,v 1.3 2015/10/12 12:07:24 cz277 Exp $
HParm      3.5.0      CUED   12/10/15  : $Id: HParm.c,v 1.2 2015/10/12 12:07:24 cz277 Exp $
HUtil      3.5.0      CUED   12/10/15  : $Id: HUtil.c,v 1.2 2015/10/12 12:07:24 cz277 Exp $
HFBLat     3.5.0      CUED   12/10/15  : $Id: HFBLat.c,v 1.2 2015/10/12 12:07:24 cz277 Exp $
HExactMPE  3.5.0      CUED   12/10/15  : $Id: HExactMPE.c,v 1.1.1.1 2006/10/11 09:54:57 jal58 Exp $
HArc       3.5.0      CUED   12/10/15  : $Id: HArc.c,v 1.2 2015/10/12 12:07:24 cz277 Exp $
HDict      3.5.0      CUED   12/10/15  : $Id: HDict.c,v 1.1.1.1 2006/10/11 09:54:57 jal58 Exp $
HLat       3.5.0      CUED   12/10/15  : $Id: HLat.c,v 1.2 2015/12/18 18:18:18 xl207 Exp $
HNet       3.5.0      CUED   12/10/15  : $Id: HNet.c,v 1.2 2015/12/18 18:18:18 xl207 Exp $
HAdapt     3.5.0      CUED   12/10/15  : $Id: HAdapt.c,v 1.3 2015/10/12 12:07:24 cz277 Exp $
HNCache    3.5.0      CUED   12/10/15  : $Id: HNCache.c,v 1.0 2015/10/12 12:07:24 cz277 Exp $

CUDA driver version 11000
CUDA runtime version 10020
CUBLAS library version 10203
GPU 0: Tesla K40c, 11441MB, SM = 3.5 [Selected]

Reading ANN models...
ANN model structure:
ANN "DNN":
	2. PERCEPTRON layer "layerin" (351 dim X 500 dim)
		Input feature mixture "layerin_feature" (351 dim), operation CONCATENATION
			Input feature stream 1 (39 dim, [1, 39]), context shift {-4, -3, -2, -1, +0, +1, +2, +3, +4}
		Weight matrix "layerin_weight" (500 dim X 351 dim) [UPDATABLE]
		Bias vector "layerin_bias" (500 dim) [UPDATABLE]
		Activation function "RELU"

	3. PERCEPTRON layer "layerout" (500 dim X 144 dim) [OUTPUT]
		Input feature mixture "layerout_feature" (500 dim), operation CONCATENATION
			ANN layer "layerin" outputs (500 dim, [1, 500]), context shift {+0}
		Weight matrix "layerout_weight" (144 dim X 500 dim) [UPDATABLE]
		Bias vector "layerout_bias" (144 dim) [UPDATABLE]
		Activation function "SOFTMAX"

3504 utterances (1067753 samples) in the training set
192 utterances (57070 samples) in the validation set
(More than) 9MB space allocated in GPU 0 memory

Epoch 1 ******************************
	Processing training set...
		Train Accuracy = 50.40% [538124 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 5.000000e-04
		Training time cost = 5.10s
	Processing validation set...
		Validation Accuracy = 52.68% [30066 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.27s


Epoch 2 ******************************
	Processing training set...
		Train Accuracy = 56.60% [604316 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 5.000000e-04
		Training time cost = 2.79s
	Processing validation set...
		Validation Accuracy = 55.41% [31623 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.15s


Epoch 3 ******************************
	Processing training set...
		Train Accuracy = 58.67% [626460 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 5.000000e-04
		Training time cost = 2.79s
	Processing validation set...
		Validation Accuracy = 56.18% [32064 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.15s


Epoch 4 ******************************
	Processing training set...
		Train Accuracy = 59.94% [640040 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 5.000000e-04
		Training time cost = 2.79s
	Processing validation set...
		Validation Accuracy = 56.45% [32216 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.14s


Epoch 5 ******************************
	Processing training set...
		Train Accuracy = 60.85% [649687 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 5.000000e-04
		Training time cost = 2.79s
	Processing validation set...
		Validation Accuracy = 57.55% [32842 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.15s


Epoch 6 ******************************
	Processing training set...
		Train Accuracy = 61.43% [655936 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 5.000000e-04
		Training time cost = 2.79s
	Processing validation set...
		Validation Accuracy = 57.64% [32894 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.14s


Epoch 7 ******************************
	Processing training set...
		Train Accuracy = 62.01% [662118 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 5.000000e-04
		Training time cost = 2.80s
	Processing validation set...
		Validation Accuracy = 58.00% [33103 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.15s


Epoch 8 ******************************
	Processing training set...
		Train Accuracy = 62.44% [666680 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 5.000000e-04
		Training time cost = 2.79s
	Processing validation set...
		Validation Accuracy = 57.90% [33046 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.15s


Epoch 9 ******************************
	Reload HMMSet generated by epoch 7
	Processing training set...
		Train Accuracy = 64.34% [686990 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 2.500000e-04
		Training time cost = 2.79s
	Processing validation set...
		Validation Accuracy = 59.46% [33936 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.15s


Epoch 10 ******************************
	Processing training set...
		Train Accuracy = 64.66% [690411 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 2.500000e-04
		Training time cost = 3.51s
	Processing validation set...
		Validation Accuracy = 59.56% [33991 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.44s


Epoch 11 ******************************
	Processing training set...
		Train Accuracy = 64.89% [692858 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 2.500000e-04
		Training time cost = 7.29s
	Processing validation set...
		Validation Accuracy = 59.52% [33970 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.43s


Epoch 12 ******************************
	Reload HMMSet generated by epoch 10
	Processing training set...
		Train Accuracy = 65.97% [704433 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 1.250000e-04
		Training time cost = 7.31s
	Processing validation set...
		Validation Accuracy = 60.15% [34325 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.44s


Epoch 13 ******************************
	Processing training set...
		Train Accuracy = 66.15% [706348 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 1.250000e-04
		Training time cost = 7.33s
	Processing validation set...
		Validation Accuracy = 60.29% [34407 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.44s


Epoch 14 ******************************
	Processing training set...
		Train Accuracy = 66.24% [707284 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 1.250000e-04
		Training time cost = 7.22s
	Processing validation set...
		Validation Accuracy = 60.03% [34257 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.33s


Epoch 15 ******************************
	Reload HMMSet generated by epoch 13
	Processing training set...
		Train Accuracy = 66.85% [713768 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 6.250000e-05
		Training time cost = 6.82s
	Processing validation set...
		Validation Accuracy = 60.58% [34573 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.43s


Epoch 16 ******************************
	Processing training set...
		Train Accuracy = 67.24% [717981 right out of 1067753 samples]
		Batch count = 1335, Update count = 1335
		Learning rate = 3.125000e-05
		Training time cost = 7.36s
	Processing validation set...
		Validation Accuracy = 60.74% [34667 right out of 57070 samples]
		Batch count = 192
		Validation time cost = 0.44s


Finish Training ***********************
	17355 updates processed in total




HTK Configuration Parameters[28]
  Module/Tool     Parameter                  Value
                  GPUID                          0
                  WEIGHTDECAY             0.001000
                  UPDATETARGETPEN              TRUE
                  UPDATEMODE            BATCHLEVEL
                  UPDATECLIP              0.320000
                  STOPDIFF                0.000100
                  SHUFFLEKIND             QUICKNET
                  RAMPSTART               0.000500
                  NEWBOBCRITERION               ACC
                  MOMENTUM                0.500000
                  MINIBATCHSIZE                800
                  MINEPOCHNUM                   12
                  MAXEPOCHNUM                   16
                  LRSCHEDULER               NEWBOB
                  LOGPRIOROBSV         -135.000000
                  LEARNRATE               0.000500
  HNCACHE         TRACE                          1
  HMATH           TRACE                          1
# HCUDA           TRACE                          1
  HANNET          TRACE                          1
                  DATACACHESIZE          200000000
                  DATAACCESSKIND         FRAMERAND
                  CRITERION                   XENT
  HPARM           VARSCALEFN      lib/info/ident_cvn_E_D_A_Z
  HPARM           VARSCALEPATHMASK             *.%%%
  HPARM           VARSCALEMASK               *.%%%
  HPARM           VARSCALEDIR     lib/cvn/cvn_E_D_A_Z
                  TARGETKIND          MFCC_E_D_A_Z

